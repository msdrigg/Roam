# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on new Tag
"on":
    push:
        tags:
            - "v*"

jobs:
    archive_and_publish:
        strategy:
            matrix:
                platform: ["iOS", "macOS", "visionOS"]
            max-parallel: 3
        runs-on: macos-14-large
        steps:
            - uses: actions/checkout@v4

            - name: Install Secret
              run: |
                  echo "${{ secrets.XCODE_API_SECRET }}" > ./.private_keys/AuthKey_${{secrets.XCODE_API_KEY}}.p8

            - name: Archive
              run: |
                  ./scripts/export.py --archive --publish --platform ${{ matrix.platform }}
              env:
                  XCODE_API_KEY: "${{ secrets.XCODE_API_KEY }}"
                  XCODE_API_ISSUER: "${{ secrets.XCODE_API_ISSUER }}"
